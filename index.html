// ... doGet 함수 내부 ...
if (e.parameter.action == 'updateLeaveStatus') {
  // ...
  var status = e.parameter.status;
  var modifiedReason = e.parameter.modifiedReason; // 'modifiedReason'을 받음
  // ...
  return updateLeaveStatus(rowNum, status, modifiedReason); // 수정된 사유를 전달
}

// ...

function updateLeaveStatus(rowNum, status, modifiedReason) {
  var sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName("외출_조퇴_신청");
  var headers = sheet.getRange(1, 1, 1, sheet.getLastColumn()).getValues()[0];
  
  // 필수 컬럼 인덱스 찾기 (코멘트 대신 '사유' 컬럼을 수정)
  var statusCol = headers.indexOf("상태") + 1;
  var timestampCol = headers.indexOf("처리일시") + 1;
  var reasonCol = headers.indexOf("사유") + 1; // '사유' 컬럼의 인덱스를 찾음
  
  // '교사코멘트' 컬럼을 더 이상 찾지 않음
  if (!statusCol || !timestampCol || !reasonCol) {
    return ContentService.createTextOutput(JSON.stringify({status: 'error', message: '필수 컬럼(상태, 처리일시, 사유)을 찾을 수 없습니다.'})).setMimeType(ContentService.MimeType.JSON);
  }

  // 데이터 업데이트
  sheet.getRange(rowNum, statusCol).setValue(status);
  sheet.getRange(rowNum, timestampCol).setValue(new Date());
  sheet.getRange(rowNum, reasonCol).setValue(modifiedReason); // '사유' 컬럼의 값을 수정된 내용으로 덮어씀
  
  return ContentService.createTextOutput(JSON.stringify({status: 'success'})).setMimeType(ContentService.MimeType.JSON);
}
